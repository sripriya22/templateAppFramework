# Template App Framework Application

This is a template application created with the Template App Framework, designed to work with MATLAB integration.

## Quick Start with Cascade

Follow this two-step process to create a new application:

### Step 1: Generate Data Model Definitions

Copy and paste the following prompt into Cascade to analyze your data file and generate model definitions:

```
I need to create JSON model definitions for a new Template App Framework application. Here are the variables I'll be using:

PROJECT_ROOT_FOLDER="templateAppFramework"     # The root folder of the project;
                                                # must contain the `appFramework`
                                                # "library" folder & `appGenerator`
                                                # tools folder
APP_FOLDER_NAME="myApp"                        # The name for your application
                                               # folder (will be created in the
                                               # `apps/` directory)
ROOT_CLASS_NAME="Configuration"                # The name for your root model class
APP_TITLE="My Application"                     # The display name of your
                                               # application
EXAMPLE_OBJECT_PATH="resources/testData.json"  # Path to your example object file

Please proceed with the setup steps in the README. If you encounter any issues, please stop and ask for clarification before proceeding.

Please analyze the example object file and create appropriate data model definitions following this format:

```json
// Root class example (only one per application)
{
    "ClassName": "Configuration",
    "IsRoot": true,
    "Description": "Root configuration class",
    "Properties": {
        "PropertyName": {
            "Type": "string",
            "IsPrimitive": true,
            "IsArray": false,
            "DefaultValue": "default value",
            "Description": "Description of the property",
            "ValidValues": ["option1", "option2", "option3"] // Optional: For string properties with constrained values
        },
        "Name": {
            "Type": "string",
            "IsPrimitive": true,
            "IsArray": false,
            "DefaultValue": "My Configuration",
            "Description": "Name of the configuration"
        }
    }
}

// Non-root class example (most of your classes will be like this)
{
    "ClassName": "ItemType",
    "Description": "A non-root model class",
    "Properties": {
        "Id": {
            "Type": "string",
            "IsPrimitive": true,
            "IsArray": false,
            "Description": "Unique identifier"
        },
        "Items": {
            "Type": "SubItemType",
            "IsPrimitive": false,
            "IsArray": true,
            "DefaultValue": [],
            "Description": "Array of sub-items"
        }
    }
}

// Class with custom superclass (must extend BaseObject or RootModel)
{
    "ClassName": "CustomClass",
    "SuperClass": "BaseCustomClass",  // Must extend BaseObject or RootModel
    "Description": "A class with custom superclass",
    "Properties": {
        // ... properties ...
    }
}
```

### Root Class Rules:
- Only one class in your model definitions should have `"IsRoot": true`
- The root class will be used as the main entry point for your application
- If no class is marked as root, an error will be thrown during code generation
- The root class will automatically inherit from `RootModel`, which extends `BaseObject`
- Non-root classes will inherit from `BaseObject` by default unless a different superclass is specified

Show me the complete model definitions I should use, and list all the class names that will be needed.
```

### Step 2: Create the Application

With the model definitions generated by Cascade from Step 1:

1. Create a temporary directory to store model definitions:

```bash
mkdir -p /tmp/model-defs
```

2. Save each model definition JSON file into this directory with proper names (e.g., `Configuration.json`, `ChildClass.json`, etc.).

3. Make sure to mark the root model class with `"IsRoot": true` in its JSON definition.

4. Run the create-app.js script from the appGenerator/utils directory:

```bash
# Navigate to the appGenerator/utils directory
cd ${PROJECT_ROOT_FOLDER}/appGenerator/utils

# Create the app directory structure
node create-app.js ${APP_FOLDER_NAME} --model-defs-dir /tmp/model-defs --title "${APP_TITLE}" --data ${EXAMPLE_OBJECT_PATH}
```

The script will:
- Automatically detect the root class from the model definitions (looking for `"IsRoot": true`)
- Copy the model definition files to your app's data-model directory
- Generate MATLAB class files in server/model/+${APP_FOLDER_NAME}
- Create all necessary application files and structure

## Setup Process Details

Your application will be created in the `$PROJECT_ROOT_FOLDER/apps/$APP_FOLDER_NAME` directory.
A root-level HTML file will also be created at `$PROJECT_ROOT_FOLDER/$APP_FOLDER_NAME.html` for serving.

### Step 2: Create ModelPanelConfig.json (Required)

**IMPORTANT**: After generating your app, you must create a correctly formatted `ModelPanelConfig.json` file for the ModelPanel to display properly.

Create or update the file at `view/config/ModelPanelConfig.json` using this format:

```json
{
  "ConfigName": "ModelPanelConfig",
  "Description": "Configuration for the Model Panel view in your app",
  "ModelClass": "${ROOT_CLASS_NAME}",
  "PropertyGroups": [
    {
      "GroupName": "Basic Settings",
      "Order": 1,
      "Properties": [
        {
          "PropertyPath": "propertyName",
          "Label": "Display Name",
          "Editable": true,
          "Order": 1
        },
        {
          "PropertyPath": "anotherProperty",
          "Label": "Another Property",
          "Editable": true,
          "Order": 2
        }
      ]
    }
  ],
  "ArrayConfigs": [
    {
      "PropertyPath": "arrayPropertyName",
      "Label": "Array Display Name",
      "Order": 1,
      "DisplayProperties": [
        {
          "PropertyPath": "subProperty1",
          "Label": "Sub-property 1",
          "Editable": true,
          "Order": 1
        },
        {
          "PropertyPath": "subProperty2",
          "Label": "Sub-property 2",
          "Editable": true,
          "Order": 2
        }
      ]
    }
  ]
}
```

### ModelPanelConfig.json Structure

The configuration contains two main sections:

1. **PropertyGroups**: For displaying and editing simple properties of your model
   - Use this for primitive properties (strings, numbers, booleans)
   - Group related properties under meaningful section names
   - Each property must specify a correct `PropertyPath` that exists in your model

2. **ArrayConfigs**: For displaying and editing arrays/collections of objects
   - Use this for arrays of model objects or complex data structures
   - The `PropertyPath` refers to the array property in your root model
   - `DisplayProperties` specify which fields of each array item to display and edit
   - This will create a table-like UI for the array items

Replace the properties in this template with the actual properties from your root class model definition. The `PropertyPath` values must match property names in your model.

You can use AI tools like Cascade to help generate this configuration based on your model definition JSON files.

### Step 3: Update App Configuration (Optional)
The App.js file already includes necessary implementation of required abstract methods. If needed, you can customize these implementations:

```javascript
// These methods are already implemented in your generated App.js
getRootClassName() {
    return '$ROOT_CLASS_NAME';
}

getRootFolderPath() {
    return '$APP_FOLDER_NAME';
}

getAppTitle() {
    return '$APP_TITLE';
}

getViewConfigName() {
    return 'ModelPanelConfig';
}

getModelClassNames() {
    // Returns model class names from your data-model directory
}

getTestDataPaths() {
    // Returns paths to test data in resources directory
}
```

### Step 3: Run the Application
Start a local web server from the `$PROJECT_ROOT_FOLDER` directory:

```bash
live-server
```

The command will return a server address. Navigate to: `$APP_FOLDER_NAME.html` from the server address to access your app.

## Project Structure
Your application has the following structure:

```
templateAppFramework/
|
├── appFramework/          # Core framework code (library)
│   ├── controller/        # Base controller classes
│   ├── model/             # Base model classes and utilities
│   ├── view/              # Base view components and utilities
│
├── appGenerator/          # Tools for creating template apps using the appFramework
│   ├── templates/         # Template files for new apps
│   └── utils/             # Generator utilities
│
|   Not tracked in git repo, but could be tracked with their own repos:
|
├── apps/                  # Directory for all applications generated using the appGenerator
│   └── myApp/             # Example application (your app folder)
│       ├── data-model/    # JSON model definitions
│       ├── resources/     # Example data files
│       ├── view/config/   # View configuration files
│       ├── myApp.html     # App-specific HTML file (for version control)
│       └── App.js         # Main application class
│
├── myApp.html             # Root-level HTML file for direct access
└── resources/             # Example object JSON data files
```

## Key Features

- **Synthetic Model Classes**: Uses JSON model definitions to create synthetic model classes at runtime
- **MATLAB Integration**: Designed to work with MATLAB's HTML component (uihtml)
- **View Configuration**: Customizable UI through JSON configuration
- **Abstract App Framework**: Clean separation between app-specific and framework code

## Development Guidelines

- Uses vanilla JavaScript with ES modules and Import Maps
- No build step required
- Apps are added to an apps/ folder that is not tracked in git as part of the templateAppFramework repo but could be tracked as separate repos
- Two HTML files are created: one in the app directory for version control, and one at the project root for direct access

## License

MIT
